---
title: "Vulnerability Index"
author: "I Nyoman Setiawan"
date: "October 24, 2022"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# MEMASUKKAN DATA
library(readxl)
dataset <- read_excel("data.xlsx")
```

```{r}
head(dataset)

# kELUARKAN PROVINSI
data <- dataset[-c(1:2,9:11,13,15,19,21:23,33)]
summary(data)

# NORMALISASI DATA
zdata<-data.frame(scale(data))
```

```{r}
################ ANALISIS FAKTOR ###############
# UJI BARTLETT
#install.packages(REdaS)
#install.packages("grid")
library(REdaS)
bart_spher(zdata)
```

```{r}
# KMO
KMOS(zdata)
```

```{r}
# MATRIX COVARIANCE
Rdata<-cov(zdata)
Rdata

```

```{r}
####################### TAHUN 2021 #############################

# MENENTUKAN BANYAK FAKTOR
#install.packages('nFactors')
library(nFactors)
eigendata<-eigen(Rdata)
eigendata

ap<-parallel(subject=20,var=10,rep=100,cent=.05)
#subject 20 artinya apa
ap$eigen
nfaktordata<-nScree(eigendata$values,ap$eigen$qevpea)
plotnScree(nfaktordata)
nfaktordata$Components
# berdasarkan aturan Kaiser kalo eigenvalue lebih dr 1
nfaktordata$Analysis
```

```{r}
# ANALISIS FAKTOR
facdata<-factanal(factors=5,covmat = Rdata, rotation='varimax') #cov matrix as input
facdata<-factanal(zdata,factors=5, scores = "regression",rotation='varimax')  #data object as input
facdata
facdata$scores
facdata$method
```
